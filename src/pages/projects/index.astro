---
import BaseLayout from "../../layouts/BaseLayout.astro";
import PageHeader from "../../components/PageHeader.astro";
import ProjectCard from "../../components/ProjectCard.astro";
import { getCollection } from "astro:content";

const allProjects = await getCollection("projects");
const projects = allProjects.sort((a, b) => {
  // Featured first, then by order
  if (a.data.featured !== b.data.featured) {
    return a.data.featured ? -1 : 1;
  }
  return a.data.order - b.data.order;
});
---

<BaseLayout
  title="Projects"
  description="Explore my portfolio of web development projects"
>
  <section class="container-custom py-12 md:py-20">
    <PageHeader
      title="Projects"
      subtitle="A collection of my work, side projects, and experiments"
    />

    {
      projects.length > 0 ? (
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          {projects.map((project, index) => (
            <ProjectCard
              project={project}
              featured={index === 0 && project.data.featured}
            />
          ))}
        </div>
      ) : (
        <div class="text-center py-20">
          <p class="text-text-secondary text-lg">
            No projects yet. Check back soon!
          </p>
        </div>
      )
    }
  </section>
</BaseLayout>
